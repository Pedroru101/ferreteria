<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test WCAG 2.1 AA - Accesibilidad Completa</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="css/accessibility.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .wcag-test-container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
        }

        .wcag-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .wcag-header h1 {
            margin: 0 0 10px 0;
            color: var(--primary, #2d7a3e);
        }

        .wcag-header p {
            color: var(--text-secondary, #4a5f4a);
            font-size: 1.1rem;
        }

        .wcag-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .wcag-controls button {
            padding: 12px 20px;
            font-size: 1rem;
            border-radius: 4px;
            border: 2px solid var(--primary, #2d7a3e);
            background: var(--primary, #2d7a3e);
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .wcag-controls button:hover {
            background: var(--primary-hover, #236030);
            transform: translateY(-2px);
        }

        .wcag-controls button:focus-visible {
            outline: 3px solid var(--focus-color, #2d7a3e);
            outline-offset: 2px;
        }

        .wcag-test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .wcag-test-card {
            background: var(--bg-card, white);
            border: 2px solid var(--border, #c8e6c9);
            border-radius: 8px;
            padding: 20px;
            transition: all 0.2s ease;
        }

        .wcag-test-card:hover {
            box-shadow: 0 4px 12px rgba(45, 122, 62, 0.15);
            border-color: var(--primary, #2d7a3e);
        }

        .wcag-test-card h3 {
            margin-top: 0;
            color: var(--primary, #2d7a3e);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .wcag-test-card .test-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: var(--primary, #2d7a3e);
            color: white;
            border-radius: 50%;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .wcag-test-card p {
            margin: 10px 0;
            color: var(--text-secondary, #4a5f4a);
            font-size: 0.95rem;
        }

        .wcag-test-card .test-status {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: bold;
            margin-top: 10px;
        }

        .test-status.pass {
            background: #4caf50;
            color: white;
        }

        .test-status.fail {
            background: #d32f2f;
            color: white;
        }

        .test-status.warning {
            background: #f57c00;
            color: white;
        }

        .test-status.pending {
            background: #0288d1;
            color: white;
        }

        .wcag-results {
            background: var(--bg-secondary, #e8f5e9);
            border: 2px solid var(--border, #c8e6c9);
            border-radius: 8px;
            padding: 30px;
            margin-top: 40px;
        }

        .wcag-results h2 {
            margin-top: 0;
            color: var(--primary, #2d7a3e);
        }

        .results-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .result-stat {
            background: white;
            padding: 15px;
            border-radius: 4px;
            text-align: center;
            border-left: 4px solid var(--border, #c8e6c9);
        }

        .result-stat.passed {
            border-left-color: #4caf50;
        }

        .result-stat.failed {
            border-left-color: #d32f2f;
        }

        .result-stat.warnings {
            border-left-color: #f57c00;
        }

        .result-stat .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary, #2d7a3e);
        }

        .result-stat .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary, #4a5f4a);
            margin-top: 5px;
        }

        .wcag-issues {
            margin-top: 30px;
        }

        .wcag-issues h3 {
            color: var(--primary, #2d7a3e);
            margin-top: 0;
        }

        .issues-list {
            background: white;
            border-radius: 4px;
            padding: 15px;
            max-height: 400px;
            overflow-y: auto;
        }

        .issues-list li {
            margin: 8px 0;
            padding: 8px;
            border-left: 3px solid #f57c00;
            padding-left: 12px;
            color: var(--text-secondary, #4a5f4a);
        }

        .wcag-recommendations {
            background: white;
            border-left: 4px solid var(--primary, #2d7a3e);
            padding: 20px;
            border-radius: 4px;
            margin-top: 20px;
        }

        .wcag-recommendations h3 {
            margin-top: 0;
            color: var(--primary, #2d7a3e);
        }

        .wcag-recommendations ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .wcag-recommendations li {
            margin: 8px 0;
            color: var(--text-secondary, #4a5f4a);
        }

        .wcag-tools {
            background: var(--bg-secondary, #e8f5e9);
            border: 2px solid var(--border, #c8e6c9);
            border-radius: 8px;
            padding: 20px;
            margin-top: 40px;
        }

        .wcag-tools h2 {
            margin-top: 0;
            color: var(--primary, #2d7a3e);
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .tool-card {
            background: white;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid var(--border, #c8e6c9);
        }

        .tool-card h4 {
            margin-top: 0;
            color: var(--primary, #2d7a3e);
        }

        .tool-card p {
            margin: 10px 0;
            font-size: 0.9rem;
            color: var(--text-secondary, #4a5f4a);
        }

        .tool-card a {
            display: inline-block;
            margin-top: 10px;
            padding: 8px 12px;
            background: var(--primary, #2d7a3e);
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .tool-card a:hover {
            background: var(--primary-hover, #236030);
        }

        .tool-card a:focus-visible {
            outline: 2px solid var(--focus-color, #2d7a3e);
            outline-offset: 2px;
        }

        .wcag-checklist {
            background: white;
            border: 2px solid var(--border, #c8e6c9);
            border-radius: 8px;
            padding: 20px;
            margin-top: 40px;
        }

        .wcag-checklist h2 {
            margin-top: 0;
            color: var(--primary, #2d7a3e);
        }

        .checklist-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid var(--border, #c8e6c9);
            gap: 12px;
        }

        .checklist-item:last-child {
            border-bottom: none;
        }

        .checklist-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checklist-item label {
            margin: 0;
            cursor: pointer;
            flex: 1;
        }

        .checklist-item input[type="checkbox"]:checked + label {
            color: var(--primary, #2d7a3e);
            font-weight: 500;
        }

        @media (max-width: 768px) {
            .wcag-test-grid {
                grid-template-columns: 1fr;
            }

            .results-summary {
                grid-template-columns: repeat(2, 1fr);
            }

            .wcag-controls {
                flex-direction: column;
            }

            .wcag-controls button {
                width: 100%;
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .wcag-test-card,
            .wcag-controls button {
                transition: none;
            }

            .wcag-controls button:hover {
                transform: none;
            }
        }
    </style>
</head>
<body>
    <div class="skip-links">
        <a href="#main-content" class="skip-link">Saltar al contenido principal</a>
        <a href="#wcag-results" class="skip-link">Ir a resultados</a>
    </div>

    <div class="wcag-test-container">
        <div class="wcag-header">
            <h1>üß™ Pruebas de Accesibilidad WCAG 2.1 AA</h1>
            <p>Validaci√≥n completa de accesibilidad para el Sistema Integral de Alambrados</p>
        </div>

        <div id="main-content">
            <div class="wcag-controls">
                <button onclick="runAllTests()" class="btn-primary">
                    <i class="fas fa-play"></i> Ejecutar Todas las Pruebas
                </button>
                <button onclick="runKeyboardTests()" class="btn-primary">
                    <i class="fas fa-keyboard"></i> Pruebas de Teclado
                </button>
                <button onclick="runContrastTests()" class="btn-primary">
                    <i class="fas fa-palette"></i> Pruebas de Contraste
                </button>
                <button onclick="toggleTheme()" class="btn-primary">
                    <i class="fas fa-moon"></i> Cambiar Tema
                </button>
            </div>

            <div class="wcag-test-grid">
                <!-- Test 1: Navegaci√≥n por Teclado -->
                <div class="wcag-test-card">
                    <h3>
                        <span class="test-number">1</span>
                        Navegaci√≥n por Teclado
                    </h3>
                    <p>Verifica que todos los elementos interactivos sean accesibles mediante teclado (Tab, Enter, Escape).</p>
                    <span class="test-status pending" id="test-1-status">Pendiente</span>
                </div>

                <!-- Test 2: Focus Visible -->
                <div class="wcag-test-card">
                    <h3>
                        <span class="test-number">2</span>
                        Focus Visible
                    </h3>
                    <p>Verifica que el foco sea claramente visible con un contorno de 3px en color primario.</p>
                    <span class="test-status pending" id="test-2-status">Pendiente</span>
                </div>

                <!-- Test 3: Focus Trap -->
                <div class="wcag-test-card">
                    <h3>
                        <span class="test-number">3</span>
                        Focus Trap en Modales
                    </h3>
                    <p>Verifica que el foco est√© atrapado dentro de los modales y no escape.</p>
                    <span class="test-status pending" id="test-3-status">Pendiente</span>
                </div>

                <!-- Test 4: ARIA Labels -->
                <div class="wcag-test-card">
                    <h3>
                        <span class="test-number">4</span>
                        ARIA Labels
                    </h3>
                    <p>Verifica que todos los elementos tengan etiquetas ARIA descriptivas o texto visible.</p>
                    <span class="test-status pending" id="test-4-status">Pendiente</span>
                </div>

                <!-- Test 5: Contraste de Colores -->
                <div class="wcag-test-card">
                    <h3>
                        <span class="test-number">5</span>
                        Contraste de Colores
                    </h3>
                    <p>Verifica que el contraste cumpla con WCAG AA (4.5:1 m√≠nimo para texto normal).</p>
                    <span class="test-status pending" id="test-5-status">Pendiente</span>
                </div>

                <!-- Test 6: Tama√±o de Toque -->
                <div class="wcag-test-card">
                    <h3>
                        <span class="test-number">6</span>
                        Tama√±o M√≠nimo de Toque
                    </h3>
                    <p>Verifica que todos los elementos interactivos tengan al menos 44x44 p√≠xeles.</p>
                    <span class="test-status pending" id="test-6-status">Pendiente</span>
                </div>

                <!-- Test 7: Formularios -->
                <div class="wcag-test-card">
                    <h3>
                        <span class="test-number">7</span>
                        Formularios Accesibles
                    </h3>
                    <p>Verifica que los campos de formulario tengan etiquetas asociadas y validaci√≥n accesible.</p>
                    <span class="test-status pending" id="test-7-status">Pendiente</span>
                </div>

                <!-- Test 8: Orden de Tabulaci√≥n -->
                <div class="wcag-test-card">
                    <h3>
                        <span class="test-number">8</span>
                        Orden de Tabulaci√≥n L√≥gico
                    </h3>
                    <p>Verifica que el orden de tabulaci√≥n sea predecible y siga el flujo visual.</p>
                    <span class="test-status pending" id="test-8-status">Pendiente</span>
                </div>

                <!-- Test 9: Roles ARIA -->
                <div class="wcag-test-card">
                    <h3>
                        <span class="test-number">9</span>
                        Roles ARIA
                    </h3>
                    <p>Verifica que los elementos tengan roles ARIA apropiados (dialog, alert, button, etc.).</p>
                    <span class="test-status pending" id="test-9-status">Pendiente</span>
                </div>

                <!-- Test 10: Alt Text -->
                <div class="wcag-test-card">
                    <h3>
                        <span class="test-number">10</span>
                        Im√°genes con Alt Text
                    </h3>
                    <p>Verifica que todas las im√°genes tengan atributo alt descriptivo.</p>
                    <span class="test-status pending" id="test-10-status">Pendiente</span>
                </div>

                <!-- Test 11: Headings -->
                <div class="wcag-test-card">
                    <h3>
                        <span class="test-number">11</span>
                        Estructura de Headings
                    </h3>
                    <p>Verifica que los headings est√©n correctamente estructurados sin saltos de nivel.</p>
                    <span class="test-status pending" id="test-11-status">Pendiente</span>
                </div>

                <!-- Test 12: Modo Oscuro -->
                <div class="wcag-test-card">
                    <h3>
                        <span class="test-number">12</span>
                        Soporte para Modo Oscuro
                    </h3>
                    <p>Verifica que el contraste se mantenga en ambos modos (claro y oscuro).</p>
                    <span class="test-status pending" id="test-12-status">Pendiente</span>
                </div>
            </div>

            <!-- Resultados -->
            <div id="wcag-results" class="wcag-results" style="display: none;">
                <h2>üìä Resultados de Pruebas</h2>
                
                <div class="results-summary">
                    <div class="result-stat passed">
                        <div class="stat-number" id="passed-count">0</div>
                        <div class="stat-label">Pruebas Pasadas</div>
                    </div>
                    <div class="result-stat failed">
                        <div class="stat-number" id="failed-count">0</div>
                        <div class="stat-label">Pruebas Fallidas</div>
                    </div>
                    <div class="result-stat warnings">
                        <div class="stat-number" id="warnings-count">0</div>
                        <div class="stat-label">Advertencias</div>
                    </div>
                    <div class="result-stat">
                        <div class="stat-number" id="pass-rate">0%</div>
                        <div class="stat-label">Tasa de √âxito</div>
                    </div>
                </div>

                <div id="issues-section" class="wcag-issues" style="display: none;">
                    <h3>üîç Problemas Detectados</h3>
                    <ul class="issues-list" id="issues-list"></ul>
                </div>

                <div class="wcag-recommendations">
                    <h3>üí° Recomendaciones</h3>
                    <ul>
                        <li>Ejecuta las pruebas regularmente para mantener la accesibilidad</li>
                        <li>Usa herramientas como axe DevTools y WAVE para validaci√≥n adicional</li>
                        <li>Prueba con lectores de pantalla (NVDA, JAWS, VoiceOver)</li>
                        <li>Verifica la navegaci√≥n por teclado en todos los m√≥dulos</li>
                        <li>Mant√©n el contraste en ambos modos (claro y oscuro)</li>
                        <li>Aseg√∫rate de que todos los elementos interactivos sean 44x44px m√≠nimo</li>
                    </ul>
                </div>
            </div>

            <!-- Herramientas Recomendadas -->
            <div class="wcag-tools">
                <h2>üõ†Ô∏è Herramientas Recomendadas para Validaci√≥n</h2>
                <div class="tools-grid">
                    <div class="tool-card">
                        <h4>axe DevTools</h4>
                        <p>Extensi√≥n para Chrome y Firefox que detecta problemas de accesibilidad autom√°ticamente.</p>
                        <a href="https://www.deque.com/axe/devtools/" target="_blank" rel="noopener">
                            Visitar Sitio
                        </a>
                    </div>

                    <div class="tool-card">
                        <h4>WAVE</h4>
                        <p>Herramienta en l√≠nea de WebAIM para evaluar accesibilidad web.</p>
                        <a href="https://wave.webaim.org/" target="_blank" rel="noopener">
                            Visitar Sitio
                        </a>
                    </div>

                    <div class="tool-card">
                        <h4>Lighthouse</h4>
                        <p>Auditor√≠a integrada en Chrome DevTools que incluye accesibilidad.</p>
                        <a href="https://developers.google.com/web/tools/lighthouse" target="_blank" rel="noopener">
                            Visitar Sitio
                        </a>
                    </div>

                    <div class="tool-card">
                        <h4>NVDA</h4>
                        <p>Lector de pantalla gratuito para Windows para probar con usuarios ciegos.</p>
                        <a href="https://www.nvaccess.org/" target="_blank" rel="noopener">
                            Descargar
                        </a>
                    </div>

                    <div class="tool-card">
                        <h4>Color Contrast Analyzer</h4>
                        <p>Herramienta para verificar ratios de contraste entre colores.</p>
                        <a href="https://www.tpgi.com/color-contrast-checker/" target="_blank" rel="noopener">
                            Visitar Sitio
                        </a>
                    </div>

                    <div class="tool-card">
                        <h4>Accessibility Insights</h4>
                        <p>Herramienta de Microsoft para evaluar accesibilidad web.</p>
                        <a href="https://accessibilityinsights.io/" target="_blank" rel="noopener">
                            Visitar Sitio
                        </a>
                    </div>
                </div>
            </div>

            <!-- Checklist de Mantenimiento -->
            <div class="wcag-checklist">
                <h2>‚úÖ Checklist de Mantenimiento de Accesibilidad</h2>
                
                <div class="checklist-item">
                    <input type="checkbox" id="check-1">
                    <label for="check-1">Todos los botones tienen aria-label o texto visible</label>
                </div>

                <div class="checklist-item">
                    <input type="checkbox" id="check-2">
                    <label for="check-2">Los inputs tienen etiquetas asociadas</label>
                </div>

                <div class="checklist-item">
                    <input type="checkbox" id="check-3">
                    <label for="check-3">El contraste cumple WCAG AA (4.5:1)</label>
                </div>

                <div class="checklist-item">
                    <input type="checkbox" id="check-4">
                    <label for="check-4">Los elementos interactivos tienen 44x44px m√≠nimo</label>
                </div>

                <div class="checklist-item">
                    <input type="checkbox" id="check-5">
                    <label for="check-5">El orden de tabulaci√≥n es l√≥gico</label>
                </div>

                <div class="checklist-item">
                    <input type="checkbox" id="check-6">
                    <label for="check-6">Los modales tienen focus trap</label>
                </div>

                <div class="checklist-item">
                    <input type="checkbox" id="check-7">
                    <label for="check-7">Las im√°genes tienen alt text</label>
                </div>

                <div class="checklist-item">
                    <input type="checkbox" id="check-8">
                    <label for="check-8">Los formularios tienen validaci√≥n accesible</label>
                </div>

                <div class="checklist-item">
                    <input type="checkbox" id="check-9">
                    <label for="check-9">Probado con lector de pantalla</label>
                </div>

                <div class="checklist-item">
                    <input type="checkbox" id="check-10">
                    <label for="check-10">Probado en modo oscuro</label>
                </div>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="js/accessibility.js"></script>
    <script src="test-accessibility-automated.js"></script>
    <script>
        let testResults = {
            passed: 0,
            failed: 0,
            warnings: 0,
            issues: []
        };

        function runAllTests() {
            console.log('Ejecutando todas las pruebas de accesibilidad...');
            
            const tester = new AccessibilityTester();
            tester.runAllTests();
            
            updateResults(tester.results);
            displayResults();
        }

        function runKeyboardTests() {
            console.log('Ejecutando pruebas de teclado...');
            
            const tester = new AccessibilityTester();
            tester.testKeyboardNavigation();
            tester.testFocusVisible();
            tester.testFocusTrap();
            tester.testTabOrder();
            
            updateResults(tester.results);
            displayResults();
        }

        function runContrastTests() {
            console.log('Ejecutando pruebas de contraste...');
            
            const tester = new AccessibilityTester();
            tester.testColorContrast();
            tester.testDarkModeSupport();
            
            updateResults(tester.results);
            displayResults();
        }

        function updateResults(results) {
            testResults.passed = results.passed.length;
            testResults.failed = results.failed.length;
            testResults.warnings = results.warnings.length;
            testResults.issues = results.issues || [];
        }

        function displayResults() {
            const resultsDiv = document.getElementById('wcag-results');
            resultsDiv.style.display = 'block';

            document.getElementById('passed-count').textContent = testResults.passed;
            document.getElementById('failed-count').textContent = testResults.failed;
            document.getElementById('warnings-count').textContent = testResults.warnings;

            const total = testResults.passed + testResults.failed;
            const passRate = total > 0 ? Math.round((testResults.passed / total) * 100) : 0;
            document.getElementById('pass-rate').textContent = passRate + '%';

            if (testResults.issues.length > 0) {
                const issuesSection = document.getElementById('issues-section');
                issuesSection.style.display = 'block';
                
                const issuesList = document.getElementById('issues-list');
                issuesList.innerHTML = '';
                
                testResults.issues.forEach(issue => {
                    const li = document.createElement('li');
                    li.textContent = issue;
                    issuesList.appendChild(li);
                });
            }

            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme') || 'light';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            accessibilityManager.announceToScreenReader(
                `Tema cambiado a ${newTheme === 'dark' ? 'oscuro' : 'claro'}`
            );
        }

        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            console.log('P√°gina de pruebas WCAG 2.1 AA cargada');
            accessibilityManager.validateAccessibility();
        });
    </script>
</body>
</html>
